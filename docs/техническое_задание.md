# **Техническое задание на разработку онлайн-чата на FastAPI с WebSocket**  

## **1. Введение**  
### **1.1. Назначение документа**  
Техническое задание описывает требования к разработке онлайн-чата с использованием FastAPI (Python) и WebSocket для обмена сообщениями в реальном времени.  

### **1.2. Цель проекта**  
Создать простое, но функциональное веб-приложение для обмена текстовыми сообщениями между пользователями с возможностью расширения функционала.  

---

## **2. Общие требования**  
### **2.1. Функциональные требования**  
#### **2.1.1. Основной функционал**  
- Регистрация и авторизация пользователей (опционально, можно начать без аутентификации).  
- Обмен сообщениями в реальном времени через WebSocket.  
- Отображение списка активных пользователей.  
- Отправка уведомлений о входе/выходе пользователей.  
- Сохранение истории сообщений в базе данных (SQLite).  

#### **2.1.2. Дополнительный функционал**  
- Поддержка нескольких комнат/чатов.  
- Индикатор набора сообщения ("User is typing...").  
- Возможность отправки файлов/изображений (опционально).  

### **2.2. Нефункциональные требования**  
- **Производительность**: Поддержка минимум 100 одновременных подключений.  
- **Безопасность**: Защита от базовых уязвимостей (SQL-инъекции, XSS).  

---

## **3. Технологический стек**  
### **3.1. Backend**  
- **Язык**: Python 3.10+  
- **Фреймворк**: FastAPI  
- **Протокол**: WebSocket (`websockets` или встроенный в FastAPI)  
- **База данных**: SQLite  
- **ORM**: SQLAlchemy (опционально) или `databases` + `sqlite3`  

### **3.2. Frontend**  
- **HTML5 + JavaScript** 
- **CSS-фреймворк**: Bootstrap 5  
- **WebSocket API**: Нативный `WebSocket` 

---

## **4. Описание API**  
### **4.1. WebSocket-эндпоинты**  
| Метод | Путь | Описание |
|--------|------|----------|
| `WS`   | `/ws/{username}` | Основное подключение к чату |  

### **4.2. HTTP-эндпоинты (опционально)**  
| Метод | Путь | Описание |
|--------|------|----------|
| `GET`  | `/`  | Главная страница чата (HTML + JS) |
| `POST` | `/register` | Регистрация пользователя (если требуется) |
| `POST` | `/login` | Авторизация (если требуется) |

---

## **5. Структура данных**  
### **5.1. База данных (SQLite)**  
#### **Таблица `users` (если есть авторизация)**  
| Поле | Тип | Описание |
|------|-----|----------|
| `id` | INTEGER (PK) | Уникальный ID пользователя |
| `username` | TEXT | Логин |
| `password_hash` | TEXT | Хэш пароля |

#### **Таблица `messages`**  
| Поле | Тип | Описание |
|------|-----|----------|
| `id` | INTEGER (PK) | ID сообщения |
| `sender` | TEXT | Имя отправителя |
| `text` | TEXT | Текст сообщения |
| `timestamp` | DATETIME | Время отправки |

---

## **6. Интерфейс (Frontend)**  
### **6.1. Основные элементы**  
- **Окно чата**: Отображение сообщений.  
- **Список пользователей**: Показывает активных участников.  
- **Поле ввода**: Для отправки новых сообщений.  
- **Кнопка отправки**: `Отправить` или `Enter`.  

### **6.2. Дизайн**  
- Адаптивный интерфейс на Bootstrap 5.  
- Минималистичный дизайн с фокусом на функциональность.  

---

## **7. Этапы разработки**  
1. **Прототип**:  
   - Настройка FastAPI + WebSocket.  
   - Базовый обмен сообщениями без БД.  
2. **База данных**:  
   - Сохранение сообщений в SQLite.  
3. **Фронтенд**:  
   - Верстка интерфейса на Bootstrap 5.  
4. **Дополнительные функции**:  
   - Индикатор набора текста.  
   - Поддержка нескольких комнат.  

---

## **8. Тестирование**  
- **Unit-тесты**: Проверка WebSocket-подключений.  
- **Интеграционные тесты**: Обмен сообщениями между клиентами.  
- **Нагрузочное тестирование**: 100+ подключений.  

---

## **9. Дополнительные требования**  
- **Документация**: Swagger/ReDoc для API.  
- **Логирование**: Запись ошибок и событий чата.